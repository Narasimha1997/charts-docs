<%
=begin
apps: etcd
platforms: kubernetes
id: add_nodes
title: Add new nodes to the cluster
category: administration
weight: 30
highlight: 30
=end %>

To add new members to the etcd cluster, two options are available:

* Scale the StatefulSet using the *kubectl scale* command. For instance, to add a new member, use the commands below:

  ~~~
  $ CURRENT_REPLICAS=$(kubectl get statefulset/my-release-etcd -o=jsonpath='{.status.replicas}')
  $ kubectl scale --replicas=$((CURRENT_REPLICAS+1)) statefulset/my-release-etcd
  ~~~

* Upgrade the StatefulSet by providing the total number of etcd members required in the etcd cluster as a parameter to the *helm upgrade* command. For instance, to add two new members, use the commands below:

  ~~~
  $ CURRENT_REPLICAS=$(kubectl get statefulset/my-release-etcd -o=jsonpath='{.status.replicas}')
  $ helm upgrade my-release <%= variable :repo_name, :platform %>/etcd \
    --set auth.rbac.rootPassword=ETCD_ROOT_PASSWORD \
    --set replicaCount=$((CURRENT_REPLICAS+2))
  ~~~

  > NOTE: Replace the placeholder ETCD_ROOT_PASSWORD with the correct password for the etcd administrator account. If the password was generated automatically, obtain the auto-generated paassword from the post-deployment instructions.
